@copilot

var,category,channel,data_type,agg_strategy,custom_tags
BING_SUPPLY_SESSIONS,paid_media_vars,bing,numeric,sum,
BING_DEMAND_SESSIONS,paid_media_vars,bing,numeric,sum,
BING_OTHER_SESSIONS,paid_media_vars,bing,numeric,sum,other
BING_COMPETITOR_SESSIONS,paid_media_vars,bing,numeric,sum,other
BING_BRAND_SESSIONS,paid_media_vars,bing,numeric,sum,other, campaign # coma separated tags "other" and "campaign" or <TAG1>, <TAG2>
BING_APP_SESSIONS,paid_media_vars,bing,numeric,sum,other, campaign

if I have values as above, I expect the following values for the mapping -> paid_media_vars in the mapping.json after I click add channel aggregation.
BING_SUPPLY_SESSIONS, BING_DEMAND_SESSIONS, BING_OTHER_SESSIONS, BING_COMPETITOR_SESSIONS BING_BRAND_SESSIONS, BING_APP_SESSIONS, BING_TOTAL_SESSIONS, BING_OTHER_CUSTOM_SESSIONS, BING_CAMPAIGN_CUSTOM_SESSIONS

Let's take

BING_OTHER_CUSTOM_SESSIONS

generated from the rows

BING_OTHER_SESSIONS,paid_media_vars,bing,numeric,sum,other # BING_OTHER_SESSIONS naming <CHANNEL_NAME>_<SUBCHANNEL>_<SUFFIX>
BING_COMPETITOR_SESSIONS,paid_media_vars,bing,numeric,sum,other
BING_BRAND_SESSIONS,paid_media_vars,bing,numeric,sum,"other, campaign"
BING_APP_SESSIONS,paid_media_vars,bing,numeric,sum,"other, campaign"

for example.
The resulting naming is structured as follows:
<CHANNEL_NAME>_<TAG1>_CUSTOM_<SUFFIX>

We should also save somewhere in the mapping.json that the column BING_OTHER_CUSTOM_SESSIONS corresponds to the sum (agg_strategy in mapping_edit df) of BING_OTHER_SESSIONS, BING_COMPETITOR_SESSIONS BING_BRAND_SESSIONS and BING_APP_SESSIONS or [agg_strategy] of all columns with the same <CHANNEL_NAME>, <SUBCHANNEL>, <SUFFIX> and (<TAG1>  or <TAG2> or .. <TAG<N>> for N in iter(len {custom_tags))).
These aggregated columns (both the TAG columns and the TOTAL columns) will be used in the
## ---------- FEATURE ENGINEERING ----------
block in r/run_all.R instead of the current hardcoded code for all the columns selected in the paid_media_spends/paid_media_vars in the "Variable mapping" section of the Experiment page.

The corresponding paid_media_vars entry on the following experiment page should be as follows

paid_media_vars
-<CHANNEL_NAME>
-- <CHANNEL_NAME>_<TAG1>_CUSTOM_<SUFFIX># <TAG1> and _CUSTOM are optional depending on whether or not custom_tags are present in the mapping_edit table from the Map Your Data page.

